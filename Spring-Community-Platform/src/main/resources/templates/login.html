<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	th:replace="~{layout/layout :: layout(content=~{::content})}">

<th:block th:fragment="content">
	<div class="row justify-content-center">
		<div class="col-md-6 col-lg-4">

			<div th:if="${error}"
				class="alert alert-danger text-center mb-3 shadow-sm"
				th:text="${error}"></div>

			<div th:if="${message}"
				class="alert alert-success text-center mb-3 shadow-sm"
				th:text="${message}"></div>

			<div th:if="${param.withdraw}"
				class="alert alert-info text-center mb-3 shadow-sm"
				th:text="#{login.alert.withdraw}">회원 탈퇴가 완료되었습니다.</div>

			<div th:if="${param.passwordChanged}"
				class="alert alert-info text-center mb-3 shadow-sm"
				th:text="#{login.alert.passwordChanged}">비밀번호가 변경되었습니다. 다시
				로그인해주세요.</div>

			<div class="card shadow-sm border-0 mt-4">
				<div class="card-body p-4">
					<h3 class="text-center mb-4 fw-bold" th:text="#{login.title}">로그인</h3>

					<form th:action="@{/login}" method="post">
						<div class="mb-3">
							<label class="form-label fw-semibold" th:text="#{login.id.label}">아이디</label>
							<input type="text" name="username" class="form-control"
								th:placeholder="#{login.id.placeholder}" required>
						</div>

						<div class="mb-2">
							<label class="form-label fw-semibold" th:text="#{login.pw.label}">비밀번호</label>
							<input type="password" name="password" class="form-control"
								th:placeholder="#{login.pw.placeholder}" required>
						</div>

						<div class="text-end mb-3">
							<a th:href="@{/account/find-password}"
								class="text-muted small text-decoration-none"
								th:text="#{login.find.account}"> 아이디 또는 비밀번호를 잊으셨나요? </a>
						</div>

						<button type="submit" class="btn btn-primary w-100 fw-bold py-2"
							th:text="#{login.btn}">로그인</button>
					</form>

					<div th:if="${param.error}" class="mt-4">

						<div th:if="${#strings.contains(param.error, '탈퇴')}"
							class="alert alert-light border text-center shadow-sm p-3">
							<div class="small mb-3 text-secondary fw-bold"
								th:text="${param.error}">탈퇴 처리된 계정입니다.</div>

							<form th:action="@{/account/restore}" method="get">
								<div class="mb-2">
									<input type="text" name="username"
										class="form-control form-control-sm text-center bg-light"
										th:value="${param.username}" readonly>
								</div>
								<button type="submit" class="btn btn-sm btn-dark w-100 fw-bold"
									th:text="#{login.error.restore.btn}">계정 복구하기</button>
							</form>
						</div>

						<div
							th:if="${#strings.contains(param.error, '인증') and !#strings.contains(param.error, '탈퇴')}"
							class="alert alert-light border text-center shadow-sm p-3">
							<div class="small mb-3 text-danger fw-bold"
								th:text="${param.error}">이메일 인증이 필요합니다.</div>

							<form th:action="@{/resend-verification}" method="get">
								<div class="mb-2">
									<input type="text" name="username"
										class="form-control form-control-sm text-center"
										th:value="${param.username}" readonly>
								</div>
								<button type="submit"
									class="btn btn-sm btn-outline-primary w-100 fw-bold">
									인증 메일 다시 받기</button>
							</form>
						</div>

						<div
							th:unless="${#strings.contains(param.error, '인증') or #strings.contains(param.error, '탈퇴')}"
							class="alert alert-danger text-center small shadow-sm p-2">
							<span th:text="${param.error}">아이디 또는 비밀번호가 일치하지 않습니다.</span>
						</div>
					</div>

					<hr class="my-4 text-muted opacity-25">

					<div class="text-center small">
						<span th:text="#{login.no.account}">아직 계정이 없으신가요?</span> <a
							th:href="@{/register}"
							class="fw-bold text-primary text-decoration-none ms-1"
							th:text="#{login.register.link}">회원가입</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</th:block>
</html>